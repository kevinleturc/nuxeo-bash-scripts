name: Tests

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

permissions:
  contents: read

jobs:
  test:
    name: Test ${{ matrix.test-name }}
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        include:
          - test-name: Common Library
            test-file: common_test.sh
          - test-name: MongoDB Script
            test-file: mongodb_test.sh
          - test-name: MySQL Script
            test-file: mysql_test.sh
          - test-name: PostgreSQL Script
            test-file: postgresql_test.sh
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Install bats
      run: |
        sudo apt-get update
        sudo apt-get install -y bats
    
    - name: Run tests
      run: bats tests/${{ matrix.test-file }}
